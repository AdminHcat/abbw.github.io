(function(){var n,s=window||this,t=s.BLOG.even,e=s.BLOG.$,i=e("#search"),a=e("#search-wrap"),r=e("#key"),o=e("#back"),c=e("#search-panel"),l=e("#search-result"),u=e("#search-tpl").innerHTML,d=(s.BLOG.ROOT+"/search.json").replace(/\/{2}/g,"/");s.BLOG.noop;var f=e("html"),p={show:function(){s.innerWidth<760&&f.classList.add("lock-size"),c.classList.add("in")},hide:function(){s.innerWidth<760&&f.classList.remove("lock-size"),c.classList.remove("in")}};function h(e){var t="";t=e.length?e.map(function(e){return t=u,n={title:e.title,path:(s.BLOG.ROOT+"/"+e.path).replace(/\/{2,}/g,"/"),date:new Date(e.date).toLocaleDateString(),tags:e.tags.map(function(e){return"<span>#"+e.name+"</span>"}).join("")},t.replace(/\{\w+\}/g,function(e){var t=e.replace(/\{|\}/g,"");return n[t]||""});var t,n}).join(""):'<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>',l.innerHTML=t}function v(e,t){return t.lastIndex=0,t.test(e)}function L(e){var t=this.value.trim();if(t){var s=new RegExp(t.replace(/[ ]/g,"|"),"gmi");!function(t){if(n)t(n);else{var e=new XMLHttpRequest;e.open("GET",d,!0),e.onload=function(){if(200<=this.status&&this.status<300){var e=JSON.parse(this.response);n=e instanceof Array?e:e.posts,t(n)}else console.error(this.statusText)},e.onerror=function(){console.error(this.statusText)},e.send()}}(function(e){h(e.filter(function(e){return n=s,v((t=e).title,n)||t.tags.some(function(e){return v(e.name,n)})||v(t.text,n);var t,n})),p.show()}),e.preventDefault()}}i.addEventListener(t,function(){a.classList.toggle("in"),r.value="",a.classList.contains("in")?r.focus():r.blur()}),o.addEventListener(t,function(){a.classList.remove("in"),p.hide()}),document.addEventListener(t,function(e){"key"!==e.target.id&&"click"===t&&p.hide()}),r.addEventListener("input",L),r.addEventListener(t,L)}).call(this);