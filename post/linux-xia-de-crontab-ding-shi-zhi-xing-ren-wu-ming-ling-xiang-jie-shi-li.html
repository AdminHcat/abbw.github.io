<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="canonical" href="https://abbw.ml/post/linux-xia-de-crontab-ding-shi-zhi-xing-ren-wu-ming-ling-xiang-jie-shi-li.html"><title>Linux下的crontab定时执行任务命令详解+示例 | 骑猪看月亮 | 一个爱分享，爱学习，偶尔发布一些小作品的是非地</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#3F51B5"><meta name="keywords" content=""><meta name="description" content="1.Cron的启动与关闭 由于Cron是Linux的内置服务，可以用以下的方法启动.关闭这个服务: &#x2F;sbin&#x2F;service crond start           &#x2F;&#x2F;启动服务 &#x2F;sbin&#x2F;service crond stop            &#x2F;&#x2F;关闭服务 &#x2F;sbin&#x2F;service crond restart        &#x2F;&#x2F;重启服务 &#x2F;sbin&#x2F;service crond re"><meta property="og:type" content="article"><meta property="og:title" content="Linux下的crontab定时执行任务命令详解+示例"><meta property="og:url" content="https://abbw.ml/post/linux-xia-de-crontab-ding-shi-zhi-xing-ren-wu-ming-ling-xiang-jie-shi-li.html"><meta property="og:site_name" content="骑猪看月亮"><meta property="og:description" content="1.Cron的启动与关闭 由于Cron是Linux的内置服务，可以用以下的方法启动.关闭这个服务: &#x2F;sbin&#x2F;service crond start           &#x2F;&#x2F;启动服务 &#x2F;sbin&#x2F;service crond stop            &#x2F;&#x2F;关闭服务 &#x2F;sbin&#x2F;service crond restart        &#x2F;&#x2F;重启服务 &#x2F;sbin&#x2F;service crond re"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2016-12-17T17:00:00.000Z"><meta property="article:modified_time" content="2016-12-18T01:00:00.000Z"><meta property="article:author" content="笨蛋海绵"><meta property="article:tag" content="骑猪看月亮"><meta property="article:tag" content="笨蛋海绵"><meta property="article:tag" content="博客"><meta name="twitter:card" content="summary"><link rel="alternate" type="application/atom+xml" title="骑猪看月亮" href="/rss.xml"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script>window.lazyScripts=[]</script><meta name="generator" content="Hexo 4.2.0"></head><body><div id="loading" class="active"></div><aside id="menu" class="hide"><div class="inner flex-row-vertical"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off"><i class="icon icon-lg icon-close"></i></a><div class="brand-wrap" style="background-image:url(/img/brand.jpg)"><div class="brand"> <a href="/" class="avatar waves-effect waves-circle waves-light"><img src="/img/avatar.jpg"></a><hgroup class="introduce"><h5 class="nickname">笨蛋海绵</h5> <a href="mailto:1037886804@qq.com" title="1037886804@qq.com" class="mail">1037886804@qq.com</a></hgroup></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="icon icon-lg icon-home"></i> 主页</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="icon icon-lg icon-archives"></i> 归档</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="icon icon-lg icon-tags"></i> 标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="icon icon-lg icon-th-list"></i> 分类</a></li><li class="waves-block waves-effect"><a href="https://github.com/abbw" target="_blank"><i class="icon icon-lg icon-github"></i> Github</a></li><li class="waves-block waves-effect"><a href="https://weibo.com/520abbw" target="_blank"><i class="icon icon-lg icon-weibo"></i> Weibo</a></li><li class="waves-block waves-effect"><a href="https://wpa.qq.com/msgrd?v=3&uin=1037886804&site=qq&menu=yes" target="_blank" rel="noopener"><i class="icon icon-lg icon-qq"></i> 联系我</a></li><li class="waves-block waves-effect"><a href="https://abbw.gitee.io" target="_blank"><i class="icon icon-lg icon-git-square"></i> 镜像站</a></li><li class="waves-block waves-effect"><a href="/Links"><i class="icon icon-lg icon-link"></i> 友情链接</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle"><i class="icon icon-lg icon-navicon"></i></a><div class="flex-col header-title ellipsis">Linux下的crontab定时执行任务命令详解+示例</div><div class="search-wrap" id="search-wrap"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"><i class="icon icon-lg icon-chevron-left"></i></a> <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search"><i class="icon icon-lg icon-search"></i></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h1 class="title">Linux下的crontab定时执行任务命令详解+示例</h1><h5 class="subtitle"> <time datetime="2016-12-17T17:00:00.000Z" itemprop="datePublished" class="page-time">2016-12-18</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux/">Linux</a></li></ul></h5></div></header><div class="container body-wrap"><article id="post-Linux下的crontab定时执行任务命令详解+示例" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title"> Linux下的crontab定时执行任务命令详解+示例</h1><div class="post-meta"> <time class="post-time" title="2016-12-18 01:00:00" datetime="2016-12-17T17:00:00.000Z" itemprop="datePublished">2016-12-18</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux/">Linux</a></li></ul><span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none"><i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><p>1.Cron的启动与关闭</p><p>由于Cron是Linux的内置服务，可以用以下的方法启动.关闭这个服务:</p><p>/sbin/service crond start //启动服务</p><p>/sbin/service crond stop //关闭服务</p><p>/sbin/service crond restart //重启服务</p><p>/sbin/service crond reload //重新载入配置</p><p>2.Cron配置文件</p><p>2.1全局配置文件</p><p>crontab在/etc目录下面存在cron.hourly,cron.daily,cron.weekly,cron.monthly,cron.d五个目录和crontab,cron.deny二个文件.</p><p>cron.daily是每天执行一次的job,cron.weekly是每个星期执行一次的job.cron.monthly是每月执行一次的job,cron.hourly是每个小时执行一次的job.cron.d是系统自动定期需要做的任务,但是又不是按小时,按天,按星期,按月来执行的,那么就放在这个目录下面.</p><p>/etc/crontab文件一般如下:</p><p>01 * * * * root run-parts /etc/cron.hourly</p><p>02 4 * * * root run-parts /etc/cron.daily</p><p>22 4 * * 0 root run-parts /etc/cron.weekly</p><p>42 4 1 * * root run-parts /etc/cron.monthly</p><p>我们可在此文件中添加自己需要的cron job.</p><p>/etc/cron.deny文件就是用于控制不让哪些用户使用Crontab的功能.</p><p>2.2用户配置文件</p><p>每个用户都有自己的cron配置文件,通过crontab -e 就可以编辑,一般情况下我们编辑好用户的cron配置文件保存退出后,系统会自动就存放于/var/spool/cron/目录中,文件以用户名命名.</p><p>linux的cron服务是每隔一分钟去读取一次/var/spool/cron,/etc/crontab,/etc/cron.d下面所有的内容.</p><p>3.Cron命令格式</p><p>crontab [ －u user ] 文件</p><p>crontab [ －u user ] { －l | －r | －e }</p><p>-u:指定某一用户</p><p>－e:执行文字编辑器来设定用户(当前用户或指定用户)时程表,内定的文字编辑器是vi.</p><p>－r:删除用户时程表.</p><p>－l:列出用户时程表.</p><p>4.Cron文件格式</p><p>* * * * * command</p><p>分 时 日 月 周　 命令</p><p>第1列表示分钟1～59, 每分钟用*或者 */1表示</p><p>第2列表示小时1～23(0表示0点)</p><p>第3列表示日期1～31</p><p>第4列表示月份1～12</p><p>第5列标识号星期0～6(0表示星期天)</p><p>第6列要运行的命令</p><p>5.Cron文件使用说明</p><p>5.1 一般情况</p><p>当f1 为 * 时表示每分钟都要执行 program,f2 为 * 时表示每小时都要执行程序,其余类推.</p><p>* * * * * /bin/usershell 每天每分钟执行一次/bin/usershell</p><p>当f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行,f2 为 a-b 时表示从第 a 到第 b 小时都要执行,其余类推.</p><p>0-12 * * * * /bin/usershell 每天每小时从0到12分钟每分钟执行一次/bin/usershell</p><p>当f1 为 */n 时表示每 n 分钟个时间间隔执行一次,f2 为 */n 表示每 n 小时个时间间隔执行一次,其余类推.</p><p>* */2 * * * /bin/usershell 每天每2小时执行一次/bin/usershell</p><p>当f1 为 a, b, c,… 时表示第 a, b, c,… 分钟要执行,f2 为 a, b, c,… 时表示第 a, b, c…个小时要执行,其余类推.</p><p>* 1,3,5,7 * * * /bin/usershell 每天每逢1,3,4,7点执行一次/bin/usershell</p><p>5.2. 冲突逻辑</p><p>日期可以用月限定,也可以用“星期”指定,如果两个段有冲突,那么,第六段的命令将在匹配任何一个的情况下都运行,比如</p><p>“30 4 1,15 * 5”,将在每月的1号和15号加每个周五,上午4：30运行.</p><p>5.3. 符号”%”</p><p>“%”在Cron文件中,有”结束命令行”,”换行”,”重定向”的作用,假如不需要”%”的特殊作用,需要使用转义符转义.</p><p>5.4. @reboot</p><p>这个不需要理解,为了达到在开机后运行,且只运行一次的目的.除了这个,也无法通过前五段的设置来实现.</p><p>@annually也是这个功能.</p><p>至于@yearly,@monthly等等其实都可以用上面的五段来设置.</p><p>然后我自己写了一个小例子做了下测试：</p><p>使用crontab -e进行编辑，内容为：</p><p>*/2 * * * * echo “i am crontab” &gt;&gt; /home/hello</p><p>这样隔两分钟就会往hello这个文件里写i am crontab</p><p>我自己写了一个脚本task.sh，直接运行task.sh时可以运行，可是加到crontab里就有运行了，后来我查看了网上的解决方法，终于解决了，先来看一下我原来写的task.sh脚本吧：</p><p>#!/bin/sh<br>java -jar offergateway.biz.offer-1.0-SNAPSHOT.jar</p><p>crontab定时任务的写法为：</p><p>* * * * * /task.sh</p><p>后来我查了网上说要运行crontab，必须使用绝对路径，然后我把路径都改成绝对路径了。</p><p>在crontab的执行环境变量中，没有相应用户设置的环境变量，你需要手动设置一下环境变量，才能让它生效。于是我把上面的脚本改成：</p><p>#!/bin/sh<br>. /etc/profile<br>java -jar /home/offergateway.biz.offer-1.0-SNAPSHOT.jar</p><p>crontab也改成绝对路径：</p><p>* * * * * sh /home/task.sh</p><p>至此，就成功啦！</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><blockquote class="post-copyright"><div class="content"> <span class="post-time">最后更新时间：<time datetime="2016-12-18T01:00:00.000Z" itemprop="dateUpdated">2016-12-18 09:00:00</time></span><br> 本文永久地址：<a href="/post/linux-xia-de-crontab-ding-shi-zhi-xing-ren-wu-ming-ling-xiang-jie-shi-li.html" target="_blank" rel="external">https://abbw.ml/post/linux-xia-de-crontab-ding-shi-zhi-xing-ren-wu-ming-ling-xiang-jie-shi-li.html</a><br> 博客内容遵循：<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></div><footer> <a href="https://abbw.ml"><img src="/img/avatar.jpg" alt="笨蛋海绵"> 笨蛋海绵</a></footer></blockquote><div class="page-reward"> <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a></div><div class="post-footer"></div></div><nav class="post-nav flex-row flex-justify-between"><div class="waves-block waves-effect prev"><a href="/post/linux-xia-tar-ming-ling-exclude-xuan-xiang-pai-chu-zhi-ding-wen-jian-huo-mu-lu.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> 上一篇</div><h4 class="title">Linux下tar命令exclude选项排除指定文件或目录</h4></a></div><div class="waves-block waves-effect next"><a href="/post/linux-zhong-jie-ya-rar-wen-jian-fang-fa.html" id="post-next" class="post-nav-link"><div class="tips">下一篇<i class="icon icon-angle-right icon-lg icon-pl"></i></div><h4 class="title">Linux中解压rar文件方法</h4></a></div></nav><p class="comments comments-tip"> 点击切换到：<a class="comments-type active">Valine</a> | <a class="comments-type">Gitee</a> | <a class="comments-type">Gitalk</a> 评论系统</p><div class="comments-mode show"><div class="comments vcomment" id="comments"></div><script src="https://abbw.gitee.io/js/av-min.js"></script><script src="https://abbw.gitee.io/js/Valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(i){return-1<GUEST_INFO.indexOf(i)});new Valine({el:"#comments",notify:!1,verify:!1,appId:"LGPIlQqU2zEYq6fK05AcGJ2z-9Nh9j0Va",appKey:"q3GQMgU398vgydqbuHD8hNbk",Email:"1037886804@qq.com",avatar:"identicon",placeholder:"你的评论是我的动力~",visitor:"identicon",guest_info:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"5"})</script></div><div class="comments-mode"><section class="comments" id="comments"><div id="giteement-ctn"></div><script src="https://abbw.gitee.io/js/crc32.js"></script><link rel="stylesheet" href="https://abbw.gitee.io/css/gitee.css"><script src="https://abbw.gitee.io/js/gitee.js"></script><script>var giteement=new Giteement({id:crc32(window.location.pathname),owner:"abbw",repo:"hexo_blog_issues",backcall_uri:"https://abbw.ml",oauth_uri:"https://cors-anywhere.herokuapp.com/https://gitee.com/oauth/token",oauth:{client_id:"dd33863e2f58e00491d7c8cadaf061a7f64a3984286609a10cb81009c5059fba",client_secret:"58862ebdec51f7579e05422ee3ca0141af12b2f1208d31197b17e14d5d707991"}});giteement.render("giteement-ctn")</script></section></div><div class="comments-mode"><section class="comments" id="comments"><div id="gitalk-container"></div><link rel="stylesheet" href="https://abbw.gitee.io/css/gitalk.css"><script src="https://abbw.gitee.io/js/gitalk.js"></script><script src="https://abbw.gitee.io/js/md5.js"></script><script>var gitalk=new Gitalk({clientID:"055205b012428d0ae41c",clientSecret:"19a9ceb2b7a11cc070a902af3bdf67e6fd745b16",repo:"hexo_blog_issues",owner:"abbw",admin:["abbw"],id:md5(window.location.pathname),distractionFreeMode:!1});gitalk.render("gitalk-container")</script></section></div><script>["sojson.v4"].filter.constructor((["sojson.v4"]+[]).constructor.fromCharCode.apply(null,"118E97s114e32e99N111G109e109v101k110y116l115H95W116S121T112I101G32d61q32V100o111e99f117g109G101f110K116Q46L103X101F116T69M108R101P109j101P110A116E115T66x121v67i108p97a115P115O78Y97B109b101L40J34Z99v111f109v109u101U110W116M115f45w116Z121P112o101K34X41a10c118t97j114C32v99x111Q109s109c101C110y116E115x95v109q111i100t101H32U61t32V100e111E99H117q109p101W110z116t46C103R101d116i69n108s101Y109S101k110J116x115C66w121n67c108A97E115s115P78G97r109p101N40t34l99p111x109t109x101e110L116r115F45j109E111g100i101U34b41u10z102B111U114d40u118Q97N114u32f105J61O48z59k105c60A99e111a109r109h101H110d116W115F95v116f121b112r101A46A108d101f110y103M116V104i59V105M43b43B41b123K10t32I32m32b32Q99b111i109c109C101P110E116V115u95G116E121l112l101J91C105V93R46x105O110I100r101g120I32E61q32O105d59h10n32i32G32i32i99G111e109a109y101m110c116w115a95T116n121B112M101m91i105m93b46f111c110y99a108N105k99j107d32O61T32T102u117Y110l99O116E105s111a110m40f41N123I10U32v32E32x32j102K111Z114S40U118r97n114R32O106H61W48W59Y106r60r99A111v109e109D101f110F116i115U95T116K121m112O101E46f108n101s110V103J116n104X59x106W43j43P41K123x10g32D32X32H32v32e32l32N32o99r111o109l109M101F110u116p115N95A116E121P112s101C91J106e93Q46X99f108o97v115i115N78n97P109l101s32T61C32W99M111w109L109v101a110C116E115M95Z116c121P112b101L91b106K93n46A99i108Y97B115M115l78h97F109e101P46R114L101i112M108k97j99n101a40g39Y32E97R99S116l105V118W101m39s44c32i39E39z41e46T116L114P105A109p40l41L59p10n32H32N32m32u32I32s32M32k99u111t109e109W101z110j116V115k95v109O111J100A101x91f106y93T46I99C108p97J115O115Z78Z97V109y101M32Z61s32s99H111J109q109x101D110O116O115r95u109u111M100B101B91e106n93G46B99x108g97H115i115W78J97l109j101y46c114p101j112H108d97M99j101s40q39h32s115s104B111V119f39x44M32f39u39O41b46E116L114v105T109G40G41w59m10K32n32c32u32K125n10l32w32Y32y32t116X104M105o115w46F99o108g97Z115y115a78x97X109B101x32N61V32b116a104T105w115m46J99W108a97Z115b115w78Y97H109B101l32M43s32f39L32A97m99t116p105K118k101U39Q59B10a32n32v32k32p99E111x109j109y101S110f116y115w95d109g111B100N101z91b116H104m105r115t46l105x110o100i101Q120f93j46t99P108r97C115W115g78k97h109W101J32g61G32P99U111t109j109i101c110F116y115x95V109r111S100h101K91V116J104z105w115w46g105H110T100q101C120d93x46A99u108z97x115S115V78r97I109V101L32m43w32j39D32C115x104q111G119h39M59T10F32W32D32h32d125m59W10D125".split(/[a-zA-Z]{1,}/)))("sojson.v4")</script></article><div id="reward" class="page-modal reward-lay"><a class="close" href="javascript:;"><i class="icon icon-close"></i></a><h3 class="reward-title"><i class="icon icon-quote-left"></i> 谢谢你请我吃糖果<i class="icon icon-quote-right"></i></h3><div class="reward-content"><div class="reward-code"> <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码"></div> <label class="reward-toggle"><input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg"><div class="reward-toggle-ctrol"> <span class="reward-toggle-item wechat">微信</span><span class="reward-toggle-label"></span> <span class="reward-toggle-item alipay">支付宝</span></div></label></div></div></div><footer class="footer"><div class="bottom"><p><span>笨蛋海绵 &copy; 2016 - 2020</span> <span>Power by <a href="//abbw.ml/" target="_blank">骑猪看月亮</a><span><a href="/rss.xml" target="_blank" class="rss" title="订阅rss"><i class="icon icon-lg icon-rss"></i></a></span><br><h id="siteTime">载入运行时间...</h><script>function siteTime(){var e=36e5,t=24*e,o=new Date,a="2016",n=o.getFullYear(),r=o.getMonth()+1,i=o.getDate(),l=o.getHours(),M=o.getMinutes(),g=o.getSeconds(),s=Date.UTC(a,"12","18","0","0","0"),f=Date.UTC(n,r,i,l,M,g)-s,h=Math.floor(f/31536e6),T=Math.floor(f/t-365*h),m=Math.floor((f-(365*h+T)*t)/e),u=Math.floor((f-(365*h+T)*t-m*e)/6e4),D=Math.floor((f-(365*h+T)*t-m*e-6e4*u)/1e3);document.getElementById("siteTime").innerHTML=a==n?"本站已缓慢运行 "+T+" 天 "+m+" 小时 "+u+" 分 "+D+" 秒":"本站已缓慢运行 "+h+" 年 "+T+" 天 "+m+" 小时 "+u+" 分 "+D+" 秒"}setInterval(siteTime,1e3)</script><p> <span id="busuanzi_container_site_uv" style="display:none">总访客数:<span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv" style="display:none">总访问量:<span id="busuanzi_value_site_pv"></span></span></p></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a><a href="javascript:;" id="gobottom" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-comments"></span></a><script src="/js/waves.min.js"></script><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!0}</script><script src="/js/main.min.js"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis"> {tags}</div> <time class="flex-col time">{date}</time></div></a></li></template><script async src="/js/search.min.js"></script><script async src="https://abbw.gitee.io/js/busuanzi.pure.mini.js"></script><script async src="https://abbw.gitee.io/js/click_love.js"></script><script async src="https://abbw.gitee.io/js/canvas-nest.min.js" color="0,0,255" opacity="0.5" zindex="-2" count="200"></script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)0<=(t=c[r].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n()},e.src=i}();var t}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this)</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script></body></html>